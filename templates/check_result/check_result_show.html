{% extends "check_result/check_result_layout.html" %}
{% load check_result_filter %}
{% load check_object_filter %}
{% block header_describe %}{% endblock %}

{% block teaser %}
{% load cache %}
{% cache 500 check_result_show user.username %}
<div class="nav_hlist">
<ul>
  {% if perms.department.cr_list or perms.department.cr_add %}
  <li class="active"><strong>检查结果详情</strong></li>
  {% endif %}
  {% if perms.department.cr_add %}
  <li class="active"><strong>检查结果录入</strong></li>
  <li><a href="{% url check_result_add 1 %}">检查结果添加</a></li>
  {% endif %}
  {% if perms.department.cr_list %}
  <li><a href="{% url check_result_list 1 %}">检查结果查询</a></li>
  {% endif %}
</ul>
</div>
{% endcache %}
{% endblock %}

{% block main %}
<!-- Insert your subtemplate content here -->
{% if check_object %}
<div class="note">
  <div class="subcolumns">
    <div class="c75l">
      <div class="subc">
        <table border="0" cellpadding="0" cellspacing="0" class="full">
          <caption>
            检查对象
          </caption>
          <thead>
            <tr><th scope="col" colspan="2">{{ check_object.name }} | {{ check_object.id_number }}</th></tr>
          </thead>
          <tbody>
            <tr>
              <th scope="row" class="sub">妻子姓名<br>身份证号</th>
              <td class="odd">{{ check_object.name }}<br>{{ check_object.id_number }}</td>
            </tr>
            <tr>
              <th scope="row" class="sub">服务区域<br>单位部门</th>
              <td class="even">{{ check_object.service_area_department.service_area.name }}<br>{{ check_object.service_area_department.department.name }}</td>
            </tr>
            <tr>
              <th scope="row" class="sub">家属<br>结婚时间</th>
              <td class="odd">{% if check_object.is_family %}是{% else %}否{% endif %}<br>{{ check_object.wedding_time|date:"Y-m-d" }}</td>
            </tr>
            <tr>
              <th scope="row" class="sub">丈夫姓名<br>身份证号</th>
              <td class="even">{{ check_object.mate_name }}<br>{{ check_object.mate_id_number }}</td>
            </tr>
            <tr>
              <th scope="row" class="sub">服务区域<br>单位部门</th>
              <td class="odd">{{ check_object.mate_service_area_department.service_area.name }}<br>{{ check_object.mate_service_area_department.department.name }}</td>
            </tr>
            <tr>
              <th scope="row" class="sub">避孕方式<br>实施时间</th>
              <td class="even">{{ check_object.ctp_method|ctp_local }}<br>{{ check_object.ctp_method_time|date:"Y-m-d" }}</td>
            </tr>
            <tr>
              <th scope="row" class="sub">创建人员</th>
              <td class="odd">{{ check_object.creater.username }}</td>
            </tr>
            <tr>
              <th scope="row" class="sub">创建时间</th>
              <td class="even">{{ check_object.created_at|date:"Y-m-d H:i:s" }}</td>
            </tr>
            <tr>
              <th scope="row" class="sub">更新时间</th>
              <td class="odd">{{ check_object.updated_at|date:"Y-m-d H:i:s" }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="c25r">
      <div class="subc important">
        <div class="center">
          <hr>
          <img src="{{ check_object.photo.url }}"/>
          <p>{{ check_object.name }}的照片</p>
          <p>{{ check_object.id_number }}</p>          
        </div>
      </div>

    </div>
  </div>
</div>
<div class="important">
  <table border="0" cellpadding="0" cellspacing="0" class="full">
    <caption>检查结果</caption>
    <thead>
      <tr><th scope="col" colspan="7">【{{ check_object.name }}】的检查结果(共{{ results.count}}项)</th></tr>
    </thead>
    <tbody>
      <tr>
        <th scope="col">编号</th>
        <th scope="col">检查项目</th>
        <th scope="col">检查结果</th>
        <th scope="col">检查时间</th>
        <th scope="col">检查人员</th>
      </tr>
      {% for result in results %}
      <tr>
        <th scope="row" class="sub">{{ forloop.counter }}</th>
        
        <td class="{% cycle 'odd' 'even' %}">{% if result.is_latest %}<p>{{ result.check_project.name }}</p>{% else %}<del>{{ result.check_project.name }}</del>{% endif %}</td>
        <td class="{% cycle 'odd' 'even' %}">{% if result.is_latest %}<p>{{ result.result|local }}</p>{% else %}<del>{{ result.result|local }}</del>{% endif %}</td>
        <td class="{% cycle 'odd' 'even' %}">{% if result.is_latest %}<p>{{ result.check_time|date:"Y-m-d H:i:s" }}</p>{% else %}<del>{{ result.check_time|date:"Y-m-d H:i:s" }}</del>{% endif %}</td>
        <td class="{% cycle 'odd' 'even' %}">{% if result.is_latest %}<p>{{ result.checker.username }}</p>{% else %}<del>{{ result.checker.username }}</del>{% endif %}</td>
      </tr>
      {% empty %}
      <th scope="col" colspan="5"><p class="warning">没有检查结果可以查询！</p></th>
      {% endfor %}
    </tbody>
  </table>

</div>
{% else %}
<p class="warning">对不起，该检查对象不存在！</p>
{% endif %}
{% endblock %}

